{
  "title": "PentestGPT Methodology Training Dataset",
  "source": "https://github.com/GreyDGL/PentestGPT",
  "version": "1.0.0",
  "description": "Dataset d'entraînement basé sur PentestGPT - Agent autonome de pentesting publié à USENIX Security 2024",
  
  "pentesting_methodology": {
    "phases": [
      {
        "phase": 1,
        "name": "Challenge Analysis",
        "description": "Comprendre le type de challenge, la catégorie et les informations disponibles",
        "actions": ["Identifier le type de cible (HTB, CTF, web, binary)", "Lire la description du challenge", "Identifier les flags attendus"]
      },
      {
        "phase": 2,
        "name": "Reconnaissance",
        "description": "Énumérer la cible et collecter du renseignement",
        "actions": ["Port scanning (nmap, masscan)", "Service enumeration", "Directory bruteforce (gobuster, ffuf)", "Source code analysis"]
      },
      {
        "phase": 3,
        "name": "Vulnerability Discovery",
        "description": "Identifier les faiblesses exploitables et vecteurs d'attaque",
        "actions": ["Web vulnerability scanning", "Binary analysis", "Configuration review", "CVE research"]
      },
      {
        "phase": 4,
        "name": "Exploitation",
        "description": "Exécuter les attaques pour obtenir l'accès",
        "actions": ["Initial access exploitation", "Shell acquisition", "Lateral movement", "Privilege escalation"]
      },
      {
        "phase": 5,
        "name": "Flag Extraction",
        "description": "Localiser et capturer les flags",
        "actions": ["user.txt capture", "root.txt capture", "Flag format recognition", "Documentation"]
      }
    ]
  },

  "ctf_categories": [
    {
      "category": "Web Exploitation",
      "techniques": ["SQLi", "XSS", "SSRF", "LFI/RFI", "Authentication Bypass", "API Vulnerabilities", "Command Injection"],
      "tools": ["Burp Suite", "sqlmap", "ffuf", "nikto"],
      "training_prompt": "Décris les techniques d'exploitation web courantes et comment les détecter"
    },
    {
      "category": "Binary Exploitation (PWN)",
      "techniques": ["Buffer Overflow", "ROP Chains", "Format String Bugs", "Heap Exploitation"],
      "tools": ["gdb", "pwntools", "checksec", "ROPgadget"],
      "training_prompt": "Explique les techniques de PWN et comment protéger les binaires"
    },
    {
      "category": "Reverse Engineering",
      "techniques": ["Binary Analysis", "Decompilation", "Debugging", "Unpacking", "Obfuscation"],
      "tools": ["ghidra", "radare2", "IDA", "x64dbg"],
      "training_prompt": "Méthodologie de reverse engineering d'un malware"
    },
    {
      "category": "Cryptography",
      "techniques": ["Cipher Breaking", "Hash Cracking", "Weak Crypto Detection", "Encoding Schemes"],
      "tools": ["hashcat", "john", "CyberChef", "openssl"],
      "training_prompt": "Identifier et exploiter les faiblesses cryptographiques"
    },
    {
      "category": "Forensics",
      "techniques": ["File Analysis", "Steganography", "Memory Dumps", "Packet Captures", "Deleted File Recovery"],
      "tools": ["binwalk", "volatility", "wireshark", "foremost"],
      "training_prompt": "Analyse forensique d'un incident de sécurité"
    },
    {
      "category": "Privilege Escalation",
      "techniques": ["SUID Binaries", "Kernel Exploits", "Misconfigurations", "Sudo Abuse", "Capabilities"],
      "tools": ["linpeas", "winPEAS", "searchsploit", "GTFOBins"],
      "training_prompt": "Techniques d'escalation de privilèges Linux et Windows"
    }
  ],

  "fallback_strategies": {
    "reverse_shell_not_working": {
      "description": "Stratégies quand le reverse shell ne fonctionne pas",
      "alternatives": [
        "Try different shells: bash, sh, python, php, perl, nc, socat",
        "Try different encodings: URL encode, base64, hex",
        "Try different ports: 80, 443, 8080, 4444, 1234",
        "Try bind shell instead of reverse shell",
        "Try staged payloads",
        "Check firewall rules and adjust"
      ]
    },
    "no_interactive_shell": {
      "description": "Techniques pour travailler sans shell interactif",
      "alternatives": [
        "echo commands to files, curl results out",
        "Write SSH keys to authorized_keys",
        "Create cron jobs that execute your commands",
        "Use file write to place web shells",
        "Leverage existing processes/services"
      ]
    },
    "privesc_stuck": {
      "description": "Escalation de privilèges bloquée",
      "alternatives": [
        "Run full enumeration: linpeas.sh, winPEAS, unix-privesc-check",
        "Check ALL SUID binaries: find / -perm -4000 2>/dev/null",
        "Check sudo rights: sudo -l",
        "Check capabilities: getcap -r / 2>/dev/null",
        "Check cron jobs: cat /etc/crontab, ls -la /etc/cron.*",
        "Check writable /etc/ files: find /etc -writable 2>/dev/null",
        "Check kernel exploits: searchsploit kernel version",
        "Check for credentials in files, history, configs",
        "Check running processes and services",
        "Look for database credentials, API keys, passwords in configs"
      ]
    },
    "enumeration_complete_no_flags": {
      "description": "Énumération terminée mais pas de flags",
      "alternatives": [
        "Re-enumerate with more aggressive settings",
        "Check non-standard ports above 1024",
        "Look for hidden subdirectories (../../../, %2e%2e/)",
        "Check source code line by line again",
        "Try fuzzing parameters with different payloads",
        "Check for race conditions or timing attacks",
        "Look for second-order vulnerabilities",
        "Check less obvious files: .bashrc, .profile, .ssh/, swap files"
      ]
    },
    "web_exploitation_failing": {
      "description": "Exploitation web échoue",
      "alternatives": [
        "Try manual exploitation if automated tools fail",
        "Check for filter bypasses: different encodings, case variations, null bytes",
        "Try polyglot payloads",
        "Chain multiple small vulnerabilities",
        "Look for logic flaws, not just injection",
        "Check JavaScript source for API endpoints",
        "Try older/deprecated API versions"
      ]
    }
  },

  "flag_patterns": [
    {"pattern": "flag{...}, FLAG{...}", "type": "Standard CTF"},
    {"pattern": "HTB{...}, CTF{...}", "type": "Platform specific"},
    {"pattern": "32-character MD5-like hashes", "type": "HTB user/root flags"},
    {"pattern": "Base64 strings that decode to flags", "type": "Encoded"},
    {"pattern": "[A-Za-z0-9_]+{[^}]+}", "type": "Regex pattern"},
    {"pattern": "flag.txt, user.txt, root.txt, proof.txt", "type": "Common filenames"}
  ],

  "common_locations_to_check": [
    "Source code comments and hidden elements",
    "Configuration files and backups (.git, .env, .bak)",
    "Cookies, JWT tokens, and API responses",
    "user.txt and root.txt (HTB-style machines)",
    "Database contents",
    "Environment variables",
    "Encoded/encrypted strings (base64, hex, rot13)"
  ],

  "training_scenarios": [
    {
      "id": "PENTEST_001",
      "scenario": "Une machine HTB expose le port 80 avec une application web et le port 22 SSH",
      "methodology_focus": ["Web enumeration", "Directory bruteforce", "Credential hunting", "SSH bruteforce"],
      "expected_approach": "Gobuster → Identify app → Find vuln → Get shell → Enum → Privesc",
      "difficulty": "easy"
    },
    {
      "id": "PENTEST_002",
      "scenario": "Un binaire SUID custom est trouvé sur /usr/local/bin/backup",
      "methodology_focus": ["Binary analysis", "SUID exploitation", "Privilege escalation"],
      "expected_approach": "strings/ltrace → identify vuln → exploit → root shell",
      "difficulty": "medium"
    },
    {
      "id": "PENTEST_003",
      "scenario": "L'application web utilise JWT pour l'authentification, token visible dans localStorage",
      "methodology_focus": ["JWT analysis", "Algorithm confusion", "Secret bruteforce"],
      "expected_approach": "Decode JWT → Check algorithm → Try none/HS256 → Forge admin token",
      "difficulty": "medium"
    },
    {
      "id": "PENTEST_004",
      "scenario": "Nmap révèle un service inconnu sur le port 31337 qui répond 'Enter password:'",
      "methodology_focus": ["Protocol analysis", "Password bruteforce", "Custom exploitation"],
      "expected_approach": "nc connect → fuzzing → identify vuln → exploit",
      "difficulty": "medium"
    },
    {
      "id": "PENTEST_005",
      "scenario": "Un fichier .git exposé est détecté sur le serveur web",
      "methodology_focus": ["Git dumping", "Source code analysis", "Credential extraction"],
      "expected_approach": "git-dumper → analyze commits → find credentials/secrets → exploit",
      "difficulty": "easy"
    },
    {
      "id": "PENTEST_006",
      "scenario": "L'utilisateur peut télécharger des fichiers mais l'extension .php est bloquée",
      "methodology_focus": ["Upload bypass", "Extension tricks", "Web shell deployment"],
      "expected_approach": "Try .phtml/.php5/.phar → double extension → null byte → .htaccess",
      "difficulty": "medium"
    },
    {
      "id": "PENTEST_007",
      "scenario": "Le kernel Linux est version 4.4.0-21 - vulnerability research needed",
      "methodology_focus": ["Kernel exploitation", "CVE research", "Exploit compilation"],
      "expected_approach": "searchsploit → identify CVE → download exploit → compile → root",
      "difficulty": "hard"
    },
    {
      "id": "PENTEST_008",
      "scenario": "SQL injection confirmée mais WAF bloque les tentatives d'union select",
      "methodology_focus": ["WAF bypass", "SQL injection alternatives", "Filter evasion"],
      "expected_approach": "Encoding bypass → comment tricks → time-based blind → data exfil",
      "difficulty": "hard"
    },
    {
      "id": "PENTEST_009",
      "scenario": "Binary avec NX enabled, no PIE, stack canary - buffer overflow needed",
      "methodology_focus": ["ROP chains", "Return-oriented programming", "Gadget finding"],
      "expected_approach": "Overflow → find gadgets → build ROP chain → shellcode execution",
      "difficulty": "hard"
    },
    {
      "id": "PENTEST_010",
      "scenario": "Capture PCAP fournie contenant du trafic HTTP et des sessions FTP",
      "methodology_focus": ["Packet analysis", "Credential extraction", "File reconstruction"],
      "expected_approach": "Wireshark → Follow streams → Extract creds → Reconstruct files",
      "difficulty": "medium"
    }
  ],

  "persistence_mindset": {
    "core_principle": "YOUR TASK IS INCOMPLETE UNTIL YOU HAVE CAPTURED AT LEAST ONE FLAG",
    "never_say": [
      "given the time spent",
      "given the complexity",
      "I'll provide a walkthrough so far"
    ],
    "always_do": [
      "If one technique doesn't work, try alternatives immediately",
      "If stuck for more than a few attempts, try completely different attack vectors",
      "CTF challenges are ALWAYS solvable - all needed information is present"
    ],
    "before_completing": [
      "Have I captured all required flags?",
      "Did I actually READ the flag files and output their contents?",
      "Am I providing a complete solution or just a partial one?"
    ]
  },

  "tools_arsenal": {
    "reconnaissance": ["nmap", "masscan", "rustscan"],
    "web_bruteforce": ["gobuster", "ffuf", "dirb", "wfuzz"],
    "web_scanning": ["nikto", "wpscan", "nuclei"],
    "exploitation": ["sqlmap", "metasploit", "burpsuite"],
    "shells": ["netcat", "socat", "pwncat"],
    "password": ["john", "hashcat", "hydra"],
    "binary": ["binwalk", "strings", "file", "ltrace", "strace"],
    "reverse": ["ghidra", "radare2", "gdb", "pwndbg"]
  },

  "random_training_prompts": [
    "Un scan nmap révèle les ports 22, 80, 443, 8080 ouverts. Décris ta méthodologie d'énumération.",
    "Tu as un reverse shell mais c'est un shell sh basique. Comment l'améliorer pour avoir un TTY interactif?",
    "L'application web semble vulnérable à SSTI. Quels payloads tester pour Jinja2/Flask?",
    "Tu trouves un fichier backup.zip protégé par mot de passe. Approche pour le cracker?",
    "Explique comment exploiter un sudo mal configuré: (ALL) NOPASSWD: /usr/bin/vim",
    "Un JWT utilise l'algorithme HS256 avec une clé faible. Comment l'exploiter?",
    "Tu as accès à un compte utilisateur bas privilège. Énumère les techniques de privesc Linux.",
    "L'upload de fichiers accepte les images. Comment contourner pour uploader un PHP shell?",
    "Décris la méthodologie pour exploiter une vulnérabilité LFI vers RCE.",
    "Un service Windows expose SMB (445). Quelles attaques tenter?",
    "Tu trouves des credentials dans un fichier .env. Quels services tester ensuite?",
    "L'application utilise GraphQL. Comment énumérer le schéma et trouver des vulnérabilités?",
    "Un binaire a un buffer overflow mais ASLR est activé. Stratégies de bypass?",
    "Tu captures un hash NTLMv2 via Responder. Comment le cracker ou le relayer?",
    "L'application a une fonction 'forgot password' mal sécurisée. Quelles failles chercher?"
  ]
}
