{
  "model_name": "ddos-expert-33",
  "base_model": "qwen2.5:3b",
  "purpose": "Expert en analyse et défense contre les attaques DDoS pour la formation en cybersécurité",
  "training_data": [
    {
      "system": "Tu es un expert en cybersécurité spécialisé dans les attaques DDoS et les stratégies de défense. Tu fournis des informations éducatives pour aider les professionnels à comprendre et se défendre contre ces menaces.",
      "instruction": "Qu'est-ce qu'une attaque DDoS?",
      "response": "Une attaque DDoS (Distributed Denial of Service) est une cyberattaque visant à submerger un système, serveur ou réseau avec un flux massif de trafic malveillant provenant de sources multiples, généralement un botnet. L'objectif est de rendre le service indisponible pour les utilisateurs légitimes.\n\n**Différence DoS vs DDoS:**\n- DoS: Une seule source d'attaque\n- DDoS: Sources multiples distribuées (botnet)\n\n**Types principaux:**\n1. Volumétriques (UDP Flood, ICMP Flood)\n2. Protocole (SYN Flood, Ping of Death)\n3. Applicatif (HTTP Flood, Slowloris)"
    },
    {
      "instruction": "Explique l'attaque HTTP/2 Rapid Reset de 2023-2024",
      "response": "L'attaque HTTP/2 Rapid Reset (CVE-2023-44487) a été une vulnérabilité critique découverte en 2023-2024 qui a établi des records d'attaques volumétriques.\n\n**Mécanisme:**\n- Exploite la fonctionnalité de multiplexage de HTTP/2\n- L'attaquant ouvre des streams HTTP/2 puis les annule immédiatement (RST_STREAM)\n- Le serveur doit traiter chaque requête avant l'annulation\n- Créé un déséquilibre asymétrique massif\n\n**Impact record:**\n- Google: 398 millions de requêtes/seconde\n- Cloudflare: 201 millions de requêtes/seconde\n- AWS: Impacts significatifs sur l'infrastructure\n\n**Mitigation:**\n- Limiter le nombre de streams simultanés\n- Rate limiting des RST_STREAM\n- Patches des serveurs HTTP/2"
    },
    {
      "instruction": "Quelles sont les tendances DDoS pour 2026?",
      "response": "**Tendances DDoS anticipées pour 2026:**\n\n1. **DDoS Applicatif (Layer 7):**\n   - Attaques plus sophistiquées ciblant les API\n   - Exploitation de vulnérabilités spécifiques aux applications\n   - Contournement des WAF traditionnels\n\n2. **IA dans les Botnets:**\n   - Optimisation automatique des vecteurs d'attaque\n   - Adaptation en temps réel aux défenses\n   - Génération de patterns de trafic ressemblant au trafic légitime\n   - Botnets auto-évolutifs\n\n3. **IoT et 5G:**\n   - Exploitation massive des appareils IoT (caméras, routeurs)\n   - Bande passante 5G utilisée pour amplification\n   - Botnets de millions d'appareils\n\n4. **Ransom DDoS (RDDoS):**\n   - Extorsion combinant DDoS et demandes de rançon\n   - Attaques de démonstration suivies de menaces\n\n5. **Multi-vecteur:**\n   - Combinaison simultanée de plusieurs types d'attaques\n   - Changement dynamique de stratégie pendant l'attaque"
    },
    {
      "instruction": "Comment fonctionne un botnet pour DDoS?",
      "response": "**Architecture d'un Botnet DDoS:**\n\n```\n[Attaquant/C2 Server]\n        |\n   [Command & Control]\n        |\n    ┌───┴───┐\n    ▼       ▼\n[Bot 1] [Bot 2] ... [Bot N]\n    │       │           │\n    └───────┴─────┬─────┘\n                  ▼\n            [Cible/Victime]\n```\n\n**Phases de création:**\n1. **Infection:** Malware infecte des appareils vulnérables\n2. **Recrutement:** Appareils rejoignent le réseau C2\n3. **Dormance:** Bots attendent les commandes\n4. **Activation:** C2 envoie l'ordre d'attaque\n5. **Attaque:** Tous les bots frappent simultanément\n\n**Protocoles C2 courants:**\n- IRC (classique)\n- HTTP/HTTPS (moderne)\n- P2P (décentralisé, plus résilient)\n- DNS tunneling (furtif)\n\n**Botnets célèbres:**\n- Mirai (IoT, 600 Gbps en 2016)\n- Mozi (P2P, appareils IoT)\n- Emotet (multi-purpose)"
    },
    {
      "instruction": "Quelles sont les techniques de défense contre les DDoS?",
      "response": "**Stratégies de Défense Multi-Couches:**\n\n**1. Niveau Réseau (Layer 3-4):**\n- Rate limiting et traffic shaping\n- Blackholing (null routing) des IPs malveillantes\n- ACL (Access Control Lists) sur routeurs\n- Anycast pour distribution géographique\n\n**2. Niveau Applicatif (Layer 7):**\n- Web Application Firewall (WAF)\n- CAPTCHA et challenges JavaScript\n- Bot management et fingerprinting\n- Rate limiting par utilisateur/session\n\n**3. Cloud & CDN:**\n- Cloudflare, Akamai, AWS Shield\n- Absorption de trafic volumétrique\n- Scrubbing centers\n- Points of Presence (PoP) globaux\n\n**4. Architecture Résiliente:**\n- Load balancing multi-région\n- Auto-scaling infrastructure\n- Redondance et failover\n- DNS avec TTL bas\n\n**5. Monitoring & Réponse:**\n- Détection d'anomalies temps réel\n- Playbooks de réponse automatisée\n- Threat intelligence feeds\n- Post-mortem et amélioration continue\n\n**KPIs à surveiller:**\n- Requêtes/seconde (RPS)\n- Bande passante entrante\n- Temps de réponse\n- Taux d'erreurs 5xx"
    },
    {
      "instruction": "Explique les attaques DDoS volumétriques",
      "response": "**Attaques DDoS Volumétriques (Layer 3-4):**\n\nL'objectif est de saturer la bande passante de la cible.\n\n**1. UDP Flood:**\n- Envoi massif de paquets UDP aléatoires\n- La cible doit vérifier chaque port (réponse ICMP)\n- Facilement généré, difficile à tracer (spoofing)\n\n**2. ICMP Flood (Ping Flood):**\n- Submersion de requêtes ICMP Echo\n- Consomme bande passante et ressources CPU\n- Amplifiable via réseaux mal configurés\n\n**3. Amplification/Réflexion:**\n- DNS Amplification (x50-70)\n- NTP Amplification (x556)\n- Memcached (x51,000 - record!)\n- SSDP, CLDAP, Chargen\n\n**Mécanisme amplification:**\n```\nAttaquant → Serveur vulnérable (IP spoofée = victime)\n                    ↓\n            Réponse amplifiée → Victime\n```\n\n**4. SYN Flood:**\n- Exploitation du handshake TCP\n- Envoi de SYN sans compléter ACK\n- Table de connexions half-open saturée\n\n**Défenses spécifiques:**\n- SYN Cookies\n- BGP Flowspec\n- BCP38 (anti-spoofing)\n- Limitation UDP/ICMP"
    },
    {
      "instruction": "Explique les attaques DDoS applicatives (Layer 7)",
      "response": "**Attaques DDoS Applicatives (Layer 7):**\n\nCiblent les ressources applicatives avec moins de bande passante mais plus d'impact.\n\n**1. HTTP Flood:**\n- GET Flood: Requêtes massives de pages/ressources\n- POST Flood: Soumissions de formulaires\n- Difficile à distinguer du trafic légitime\n\n**2. Slowloris:**\n- Connexions HTTP partielles maintenues ouvertes\n- Headers envoyés très lentement\n- Épuise le pool de connexions du serveur\n- Nécessite peu de bande passante\n\n**3. Slow POST (R.U.D.Y.):**\n- Comme Slowloris mais avec le body\n- Content-Length élevé, données au goutte-à-goutte\n\n**4. API Abuse:**\n- Endpoints coûteux ciblés (recherche, graphQL)\n- Requêtes légitimes mais intensives\n- Exploitation de fonctionnalités gourmandes\n\n**5. Cache Bypass:**\n- Paramètres aléatoires pour éviter le cache\n- Force le backend à traiter chaque requête\n\n**Défenses spécifiques:**\n- WAF avec règles comportementales\n- Rate limiting intelligent\n- Bot detection (CAPTCHA, fingerprinting)\n- Timeout agressifs sur connexions\n- Monitoring des endpoints sensibles"
    },
    {
      "instruction": "Comment détecter une attaque DDoS en cours?",
      "response": "**Indicateurs de Détection DDoS:**\n\n**Signes Réseau:**\n- Spike soudain de bande passante entrante\n- Latence anormalement élevée\n- Perte de paquets importante\n- Connexions depuis régions inhabituelles\n- Ratio upload/download anormal\n\n**Signes Applicatifs:**\n- Augmentation brutale des erreurs 5xx\n- Temps de réponse dégradé\n- Sessions expirées massivement\n- Utilisation CPU/RAM anormale\n- Files d'attente bases de données saturées\n\n**Outils de Détection:**\n```bash\n# Monitoring temps réel\nnetstat -an | grep SYN_RECV | wc -l\nss -s  # Statistiques sockets\nvnstat -l  # Bande passante live\n\n# Analyse logs\ntail -f /var/log/nginx/access.log | awk '{print $1}' | sort | uniq -c | sort -rn | head\n```\n\n**Métriques à alerter:**\n- RPS > baseline × 10\n- Bande passante > 80% capacité\n- Connexions SYN_RECV > 1000\n- Top IP représente > 10% trafic\n- GeoIP: >50% trafic d'un pays inhabituel\n\n**SIEM Rules:**\n- Corrélation multi-source\n- Baseline adaptatif\n- Alertes graduées (warning → critical)"
    },
    {
      "instruction": "Qu'est-ce que le Ransom DDoS (RDDoS)?",
      "response": "**Ransom DDoS (RDDoS) - Attaques par Extorsion:**\n\n**Définition:**\nCombine une attaque DDoS (ou menace d'attaque) avec une demande de rançon, généralement en cryptomonnaie.\n\n**Modus Operandi:**\n\n**Phase 1 - Reconnaissance:**\n- Identification de cibles vulnérables\n- Évaluation de la valeur business\n- Recherche de faiblesses\n\n**Phase 2 - Démonstration:**\n- Courte attaque (15-30 min) pour prouver la capacité\n- Suffisant pour causer des perturbations\n- Message envoyé pendant ou après\n\n**Phase 3 - Extorsion:**\n- Lettre de rançon avec deadline\n- Demande Bitcoin/Monero\n- Menace d'attaque plus longue/intense\n\n**Phase 4 - Escalade (si non-paiement):**\n- Attaque prolongée (heures/jours)\n- Augmentation de l'intensité\n- Possible pivot vers autres vecteurs\n\n**Groupes Notoires:**\n- Fancy Bear (APT28 imposteurs)\n- Armada Collective\n- Lazarus Group\n\n**Recommandations:**\n❌ NE JAMAIS PAYER - Aucune garantie\n✅ Préparer défenses à l'avance\n✅ Plan de réponse incident\n✅ Signaler aux autorités (ANSSI, FBI IC3)\n✅ Contacter anti-DDoS provider"
    },
    {
      "instruction": "Comment l'IA est utilisée dans les botnets modernes?",
      "response": "**Intelligence Artificielle dans les Botnets DDoS:**\n\n**1. Optimisation des Attaques:**\n- ML pour identifier les vecteurs les plus efficaces\n- Apprentissage des patterns de défense de la cible\n- Adaptation en temps réel de la charge\n- Prédiction des seuils de saturation\n\n**2. Évasion de Détection:**\n- Génération de trafic mimant le comportement humain\n- Rotation intelligente des signatures\n- Timing adaptatif pour éviter les alertes\n- Contournement des CAPTCHA (vision par ordinateur)\n\n**3. Recrutement de Bots:**\n- Scanning automatisé pour vulnérabilités\n- Exploitation intelligente des IoT\n- Propagation auto-optimisée\n- Sélection des cibles d'infection\n\n**4. Command & Control:**\n- Algorithmes de génération de domaines (DGA)\n- Communication chiffrée adaptative\n- Résilience décentralisée\n\n**5. Défense (côté Blue Team):**\n- Détection d'anomalies par ML\n- Classification de trafic automatisée\n- Prédiction d'attaques\n- Response orchestration\n\n**Tendance 2026:**\nLes botnets utiliseront des modèles LLM légers pour:\n- Générer des payloads polymorphiques\n- Adapter le social engineering\n- Automatiser la réponse aux contre-mesures"
    },
    {
      "instruction": "Donne un exemple de configuration anti-DDoS pour Nginx",
      "response": "**Configuration Nginx Anti-DDoS:**\n\n```nginx\n# /etc/nginx/nginx.conf\n\nhttp {\n    # Rate limiting zones\n    limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;\n    limit_conn_zone $binary_remote_addr zone=conn_limit:10m;\n    \n    # Timeouts agressifs (anti-slowloris)\n    client_body_timeout 10s;\n    client_header_timeout 10s;\n    keepalive_timeout 15s;\n    send_timeout 10s;\n    \n    # Limites de buffer\n    client_body_buffer_size 1k;\n    client_header_buffer_size 1k;\n    client_max_body_size 1m;\n    large_client_header_buffers 2 1k;\n    \n    server {\n        listen 80;\n        \n        # Rate limiting\n        limit_req zone=req_limit burst=20 nodelay;\n        limit_conn conn_limit 10;\n        \n        # Bloquer les user-agents suspects\n        if ($http_user_agent ~* (curl|wget|python|libwww|scan)) {\n            return 403;\n        }\n        \n        # GeoIP blocking (optionnel)\n        # if ($geoip_country_code !~ (CA|US|FR)) {\n        #     return 403;\n        # }\n        \n        # Bloquer les requêtes sans Host\n        if ($host = '') {\n            return 444;\n        }\n        \n        location / {\n            # Protection additionnelle\n            limit_except GET POST {\n                deny all;\n            }\n        }\n    }\n}\n```\n\n**iptables companion:**\n```bash\n# Limite SYN flood\niptables -A INPUT -p tcp --syn -m limit --limit 1/s --limit-burst 3 -j ACCEPT\n\n# Drop fragments\niptables -A INPUT -f -j DROP\n\n# Limite ICMP\niptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT\n```"
    },
    {
      "instruction": "Comment fonctionne Cloudflare pour protéger contre les DDoS?",
      "response": "**Protection DDoS de Cloudflare:**\n\n**Architecture:**\n```\n[Attaquant] → [Cloudflare Edge (200+ PoPs)] → [Origine]\n                     ↓\n              Filtrage & Scrubbing\n                     ↓\n              Trafic légitime seulement\n```\n\n**Couches de Protection:**\n\n**1. Always-On DDoS Protection (Gratuit):**\n- Analyse inline de tout le trafic\n- Détection automatique L3/L4\n- Mitigation sans intervention manuelle\n- Capacité réseau: 192+ Tbps\n\n**2. WAF (Web Application Firewall):**\n- Règles OWASP Top 10\n- Rate limiting intelligent\n- Rules custom\n- Managed rulesets\n\n**3. Bot Management:**\n- Fingerprinting browser\n- Challenge JavaScript\n- Machine learning detection\n- Turnstile (CAPTCHA moderne)\n\n**4. Spectrum (L4):**\n- Protection TCP/UDP services\n- SSH, Gaming, Voix\n- Magic Transit pour réseaux entiers\n\n**5. Advanced DDoS:**\n- Adaptive DDoS protection\n- Customizable sensitivity\n- Security analytics\n- API abuse detection\n\n**Configuration recommandée:**\n- Mode SSL: Full (Strict)\n- Security Level: Medium → High si attaque\n- Challenge Passage: 30 minutes\n- Rate Limiting: Configuré par endpoint\n- Firewall Rules: GeoIP + Threat Score"
    }
  ]
}
